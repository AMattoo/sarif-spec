<?xml version="1.0" encoding="UTF-8"?>
<warning xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="/media/xmlschemas/warning_report_reml.xsd" line_number="2218" firstdetected="Wed Feb  1 09:28:46 2017" rank="50.0555000305" warningclass="Buffer Overrun" cluster="621fa87bdeabbc6d" cluster_representative="True" report_representative="True" detected="Wed Jan  3 17:01:17 2018" filename="/r0/paul/examples/gnuchess-5.07/src/lexpgn.c" priority="None" state="None" score="49.9444999695" significance="Security" finding="None" start_procedure="return_append_str" fingerprint="4493bf3839265fe2" report_id="471" language="C" modified="Wed Jan  3 17:01:17 2018" instance_id="739799" procedure="return_append_str">
    <project name="Gnuchess" url="/project/3.xml"/>
    <analysis analysis_name="Gnuchess analysis 54" analysis_id="1198" url="/analysis/1198.xml"/>
    
    <categories><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/LANG/LANG.MEM.BO.html">LANG.MEM.BO</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2012%3A18.1">Misra2012:18.1</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2012%3A18.2">Misra2012:18.2</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2012%3A21.17">Misra2012:21.17</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2004%3A17.1">Misra2004:17.1</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2004%3A17.2">Misra2004:17.2</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#MisraC%2B%2B2008%3A5-0-16">MisraC++2008:5-0-16</category><category url="http://cwe.mitre.org/data/definitions/120.html">CWE:120</category><category url="http://cwe.mitre.org/data/definitions/788.html">CWE:788</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/TS17961.html#TS17961%3Ataintsink">TS17961:taintsink</category><category url="https://www.securecoding.cert.org/confluence/display/c/">CERT-C:ARR30-C</category><category url="https://www.securecoding.cert.org/confluence/display/c/">CERT-C:STR31-C</category><category url="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=637">CERT-CPP:CTR50-CPP</category><category url="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=637">CERT-CPP:STR50-CPP</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/DISA.html#DISA-4r3">DISA-4r3:V-70277</category><category url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/DISA.html#DISA-3r10">DISA-3r10:V-6165</category></categories>

    <similar_instances/><listing><procedure name="return_append_str" sfid="10000020.0" sfhash="d8ded769b8869674" line="2210"><file name="/r0/paul/examples/gnuchess-5.07/src/lexpgn.c" sfid="10000020.0" sfhash="d8ded769b8869674"/><line number="2210"><s keyword="1"><c>char</c></s><s><c> *</c></s><s interesting="1" on_path="1"><c>return_append_str(</c></s><s keyword="1"><c>char</c></s><s><c> *</c></s><s><c>dest, </c></s><s keyword="1"><c>const</c></s><s><c> </c></s><s keyword="1"><c>char</c></s><s><c> *</c></s><s taint="fd1"><c>s</c></s><s interesting="1" on_path="1"><c>)</c></s><s><c> {
</c></s></line><line number="2211"><s comment="1"><c>/* Append text s to dest, and return new result. */</c></s><s><c>
</c></s></line><line number="2212"><s><c>	</c></s><s keyword="1"><c>char</c></s><s><c> *newloc;
</c></s></line><line number="2213"><s><c>	size_t newlen;
</c></s></line><line number="2214"><s><c>	</c></s><s comment="1"><c>/* This doesn't have buffer overflow vulnerabilities, because
</c></s></line><line number="2215"><s comment="1"><c>	   we always allocate for enough space before appending. */</c></s><s><c>
</c></s></line><line number="2216" on_path="1"><s><c>	</c></s><s keyword="1"><c>if</c></s><s><c> (!</c></s><s on_path="1"><c>dest</c></s><s><c>) {
</c></s><msg id="m1" detail="2"><msg_control syntax_kind="if" edge="then"><msg_control_point expr="dest" value="false"/></msg_control></msg></line><line number="2217" on_path="1"><s><c>		</c></s><s interesting="1" on_path="1" taint="fd1"><c>newloc</c></s><s interesting="1" on_path="1"><c> = (</c></s><s keyword="1" interesting="1" on_path="1"><c>char</c></s><s interesting="1" on_path="1"><c> *)</c></s><s><c> </c></s><s interesting="1" on_path="1" taint="fd0 fd1"><c>malloc</c></s><s interesting="1" on_path="1"><c>(</c></s><s interesting="1" on_path="1" taint="fd0"><c>strlen</c></s><s interesting="1" on_path="1"><c>(</c></s><s interesting="1" on_path="1" taint="fd1"><c>s</c></s><s interesting="1" on_path="1"><c>))+1</c></s><s><c>;
</c></s><msg id="m2" detail="1"><msg_assignment last_before_call="1" callee="strlen" disposition="param"><msg_ap_param expr="s" is_only="1"/><msg_value disposition="variable" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_abs_loc disposition="user" name="s"/></msg_dev><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_abs_loc disposition="user" name="s"/></msg_dev></msg_eval></msg_value><msg_role role_kind="ROLE_BO_CAPACITY"><msg_value disposition="variable" cyclic="0"><msg_eval><msg_dev a="1" b="1" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value></msg_role></msg_assignment></msg><msg id="m3" detail="2"><msg_assignment disposition="return"><msg_ap_return procedure="strlen"/><msg_value disposition="variable" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_attribute name="term"><msg_ap_param expr="s" is_only="1"/></msg_ap_attribute></msg_dev><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value><link msg="m2"/></msg_assignment></msg><msg id="m4" detail="2"><msg_assignment last_before_call="1" callee="malloc" disposition="param"><msg_ap_param expr="strlen(s)" is_only="1"/><msg_value disposition="variable" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_temp expr="strlen(s)"/></msg_dev><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value><link msg="m3"/></msg_assignment></msg><msg id="m5" detail="1"><msg_assignment disposition="return"><msg_ap_return procedure="malloc"/><msg_value disposition="heap_address" cyclic="1"><msg_gen_eval temp="1"><msg_dev a="1" b="0" c="1"><msg_ap_return_summary procedure="malloc" expr="malloc(strlen(s))"/></msg_dev></msg_gen_eval></msg_value><msg_role role_kind="ROLE_BO_PTR"><msg_value disposition="variable" cyclic="0"><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_add><msg_ap_return procedure="malloc"/><msg_ap_number value="1"/></msg_ap_add></msg_dev><link sfhash="5c4962fc5fdbbb2d" line="39" local="1">malloc.c:39</link></msg_eval></msg_value></msg_role></msg_assignment></msg><msg id="m6" detail="2"><msg_assignment function_summary="malloc" disposition="other"><msg_ap_attribute name="alloc"><msg_ap_return_summary procedure="malloc" expr="malloc(strlen(s))"/></msg_ap_attribute><msg_value disposition="variable" cyclic="0"><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value><link msg="m4"/></msg_assignment></msg><msg id="m7" detail="2"><msg_assignment disposition="other"><msg_ap_abs_loc disposition="user" name="newloc"/><msg_value disposition="heap_address" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_add><msg_ap_temp expr="malloc(strlen(s))"/><msg_ap_number value="1"/></msg_ap_add></msg_dev><msg_gen_eval temp="1"><msg_dev a="1" b="0" c="1"><msg_ap_add><msg_ap_return_summary procedure="malloc" expr="malloc(strlen(s))"/><msg_ap_number value="1"/></msg_ap_add></msg_dev></msg_gen_eval></msg_value><link msg="m5"/></msg_assignment></msg></line><line number="2218" on_path="1"><s><c>		</c></s><s super_interesting="1" on_path="1"><c>strcpy(</c></s><s interesting="1" on_path="1" taint="fd1"><c>newloc</c></s><s><c>, </c></s><s interesting="1" on_path="1" taint="fd1"><c>s</c></s><s super_interesting="1" on_path="1"><c>)</c></s><s><c>;
</c></s><msg id="m8" detail="1"><msg_assignment callee="strcpy" disposition="param"><msg_ap_param expr="s" number="2"/><msg_value disposition="variable" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_abs_loc disposition="user" name="s"/></msg_dev><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_abs_loc disposition="user" name="s"/></msg_dev></msg_eval></msg_value><msg_role role_kind="ROLE_BO_POSITION"><msg_value disposition="variable" cyclic="0"><msg_eval><msg_dev a="1" b="1" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value></msg_role></msg_assignment></msg><msg id="m9" detail="2"><msg_assignment last_before_call="1" callee="strcpy" disposition="param"><msg_ap_param expr="newloc" number="1"/><msg_value disposition="heap_address" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_abs_loc disposition="user" name="newloc"/></msg_dev><msg_gen_eval temp="1"><msg_dev a="1" b="0" c="1"><msg_ap_add><msg_ap_return_summary procedure="malloc" expr="malloc(strlen(s))"/><msg_ap_number value="1"/></msg_ap_add></msg_dev><link msg="m5">lexpgn.c:2217</link></msg_gen_eval></msg_value><link msg="m7"/></msg_assignment></msg><msg id="m10" is_endbox="1"><msg_buf_overrun frames="4" nodes="39" stack_depth="2" collapsed_calls="8" control_points="1" dominating_control_points="1" visible_frames="2" visible_nodes="11" visible_stack_depth="1" visible_collapsed_calls="2" visible_control_points="1" visible_dominating_control_points="1" events="9" assignment_events="8" precond_events="0" pnodes="522" relevant_pnodes="120" indirect_calls="0" taintedness="0" rule="SATISFIED" dp_refinement_exact="CS_DISABLED" dp_refinement_approximate="CS_TIMEOUT" endpt_libmodel="strcpy" storage_class="heap" is_write="1" written_value_is_constant="0" is_total="1"><msg_buffer_ptr><msg_value disposition="heap_address" cyclic="0"><msg_dev a="1" b="0" c="1"><msg_ap_param expr="newloc" number="1"/></msg_dev><msg_gen_eval temp="1"><msg_dev a="1" b="0" c="1"><msg_ap_add><msg_ap_return_summary procedure="malloc" expr="malloc(strlen(s))"/><msg_ap_number value="1"/></msg_ap_add></msg_dev><link msg="m5">lexpgn.c:2217</link></msg_gen_eval></msg_value><link msg="m9"/></msg_buffer_ptr><msg_buffer_capacity><msg_bounds><msg_value disposition="variable" cyclic="0"><msg_eval><msg_dev a="1" b="0" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value><msg_upper_value><msg_upper_bound/></msg_upper_value><msg_lower_value><msg_lower_bound><msg_value disposition="constant" cyclic="0"><msg_eval><msg_dev_const b="0" n="0" d="1" is_ptr="0"/></msg_eval></msg_value></msg_lower_bound></msg_lower_value></msg_bounds><link msg="m6"/><link msg="m9"/></msg_buffer_capacity><msg_access><msg_bounds><msg_value disposition="variable" cyclic="0"><msg_dev a="1" b="1" c="1"><msg_ap_attribute name="term"><msg_ap_param expr="s" number="2"/></msg_ap_attribute></msg_dev><msg_eval><msg_dev a="1" b="1" c="1"><msg_ap_attribute name="term"><msg_ap_abs_loc disposition="user" name="s"/></msg_ap_attribute></msg_dev></msg_eval></msg_value><msg_upper_value><msg_upper_bound/></msg_upper_value><msg_lower_value><msg_lower_bound><msg_value disposition="constant" cyclic="0"><msg_eval><msg_dev_const b="1" n="1" d="1" is_ptr="0"/></msg_eval></msg_value></msg_lower_bound></msg_lower_value></msg_bounds><link msg="m8"/></msg_access><link msg="m6"/><link msg="m8"/><link msg="m9"/><link msg="all"/></msg_buf_overrun></msg></line></procedure></listing><notes>
        </notes>
          
</warning>