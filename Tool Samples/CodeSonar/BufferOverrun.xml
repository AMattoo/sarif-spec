<?xml version="1.0"?>

<warning  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="/media/xmlschemas/warning_report.xsd" line_number="2218" firstdetected="Wed Feb  1 09:28:46 2017" rank="50.0555000305" warningclass="Buffer Overrun" cluster="621fa87bdeabbc6d" cluster_representative="True" report_representative="True" detected="Wed Jan  3 17:01:17 2018" filename="/r0/paul/examples/gnuchess-5.07/src/lexpgn.c" priority="None" state="None" score="49.9444999695" significance="Security" finding="None" start_procedure="return_append_str" fingerprint="4493bf3839265fe2" report_id="471" language="C" modified="Wed Jan  3 17:01:17 2018" instance_id="739799" procedure="return_append_str"
>
    <project name="Gnuchess"  url="/project/3.xml"/>
    <analysis analysis_name="Gnuchess analysis 54" analysis_id="1198"  url="/analysis/1198.xml"/>
    
    <categories><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/LANG/LANG.MEM.BO.html">LANG.MEM.BO</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2012%3A18.1">Misra2012:18.1</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2012%3A18.2">Misra2012:18.2</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2012%3A21.17">Misra2012:21.17</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2004%3A17.1">Misra2004:17.1</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#Misra2004%3A17.2">Misra2004:17.2</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/MISRA.html#MisraC%2B%2B2008%3A5-0-16">MisraC++2008:5-0-16</category><category  url="http://cwe.mitre.org/data/definitions/120.html">CWE:120</category><category  url="http://cwe.mitre.org/data/definitions/788.html">CWE:788</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/TS17961.html#TS17961%3Ataintsink">TS17961:taintsink</category><category  url="https://www.securecoding.cert.org/confluence/display/c/">CERT-C:ARR30-C</category><category  url="https://www.securecoding.cert.org/confluence/display/c/">CERT-C:STR31-C</category><category  url="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=637">CERT-CPP:CTR50-CPP</category><category  url="https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=637">CERT-CPP:STR50-CPP</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/DISA.html#DISA-4r3">DISA-4r3:V-70277</category><category  url="/install/codesonar/doc/html/CodeSonar.html#WarningClasses/DISA.html#DISA-3r10">DISA-3r10:V-6165</category></categories>

    <similar_instances></similar_instances><listing><procedure line="2210" sfid="10000020.0" name="return_append_str" sfhash="d8ded769b8869674"><file sfid="10000020.0" name="/r0/paul/examples/gnuchess-5.07/src/lexpgn.c" sfhash="d8ded769b8869674" /><line number="2210"><s keyword="1"><c>char</c></s><s><c> *</c></s><s interesting="1" on_path="1"><c>return_append_str(</c></s><s keyword="1"><c>char</c></s><s><c> *</c></s><s><c>dest, </c></s><s keyword="1"><c>const</c></s><s><c> </c></s><s keyword="1"><c>char</c></s><s><c> *</c></s><s taint="fd1"><c>s</c></s><s interesting="1" on_path="1"><c>)</c></s><s><c> {
</c></s></line><line number="2211"><s comment="1"><c>/* Append text s to dest, and return new result. */</c></s><s><c>
</c></s></line><line number="2212"><s><c>	</c></s><s keyword="1"><c>char</c></s><s><c> *newloc;
</c></s></line><line number="2213"><s><c>	size_t newlen;
</c></s></line><line number="2214"><s><c>	</c></s><s comment="1"><c>/* This doesn&apos;t have buffer overflow vulnerabilities, because
</c></s></line><line number="2215"><s comment="1"><c>	   we always allocate for enough space before appending. */</c></s><s><c>
</c></s></line><line on_path="1" number="2216"><s><c>	</c></s><s keyword="1"><c>if</c></s><s><c> (!</c></s><s on_path="1"><c>dest</c></s><s><c>) {
</c></s><msg msg_id="1" detail="2">Taking true branch.  <code>dest</code> evaluates to <code>false</code>.</msg></line><line on_path="1" number="2217"><s><c>		</c></s><s interesting="1" on_path="1" taint="fd1"><c>newloc</c></s><s interesting="1" on_path="1"><c> = (</c></s><s interesting="1" on_path="1" keyword="1"><c>char</c></s><s interesting="1" on_path="1"><c> *)</c></s><s><c> </c></s><s interesting="1" on_path="1" taint="fd0 fd1"><c>malloc</c></s><s interesting="1" on_path="1"><c>(</c></s><s interesting="1" on_path="1" taint="fd0"><c>strlen</c></s><s interesting="1" on_path="1"><c>(</c></s><s interesting="1" on_path="1" taint="fd1"><c>s</c></s><s interesting="1" on_path="1"><c>))+1</c></s><s><c>;
</c></s><msg msg_id="2" detail="1"><code>s</code> is passed to <code>strlen()</code>.<ul><li>This determines the capacity of the buffer that will be overrun later.</li></ul></msg><msg msg_id="3" detail="2"><code>strlen()</code> returns the length of the string pointed to by <code>s</code>.<link  msg="m2"></link></msg><msg msg_id="4" detail="2"><code>strlen(s)</code>, which evaluates to the length of the string pointed to by <code>s</code>, is passed to <code>malloc()</code>.<link  msg="m3"></link></msg><msg msg_id="5" detail="1"><code>malloc()</code> returns the address of a new object.<ul><li>This points to the buffer that will be overrun later.</li></ul></msg><msg msg_id="6" detail="2">Inside <code>malloc()</code>, the capacity of the buffer pointed to by <code>malloc(strlen(s))</code> is set to the length of the string pointed to by <code>s</code>.<link  msg="m4"></link></msg><msg msg_id="7" detail="2"><code>newloc</code> is set to <code>malloc(strlen(s)) + 1</code>.<link  msg="m5"></link></msg></line><line on_path="1" number="2218"><s><c>		</c></s><s on_path="1" super_interesting="1"><c>strcpy(</c></s><s interesting="1" on_path="1" taint="fd1"><c>newloc</c></s><s><c>, </c></s><s interesting="1" on_path="1" taint="fd1"><c>s</c></s><s on_path="1" super_interesting="1"><c>)</c></s><s><c>;
</c></s><msg msg_id="8" detail="1"><code>s</code> is passed to <code>strcpy()</code> as the second argument.<ul><li>This determines the position accessed during the buffer overrun later.</li></ul></msg><msg msg_id="9" detail="2"><code>newloc</code>, which evaluates to <code>malloc(strlen(s)) + 1</code><subscript><link  msg="m5">lexpgn.c:2217</link></subscript>, is passed to <code>strcpy()</code> as the first argument.<link  msg="m7"></link></msg><msg msg_id="10">This code writes past the end of the buffer pointed to by <code>newloc</code>.<ul><li><code>newloc</code> evaluates to <code>malloc(strlen(s)) + 1</code><subscript><link  msg="m5">lexpgn.c:2217</link></subscript>.</li><li><code>strcpy()</code> writes to the byte at an offset that is the length of the string pointed to by <code>s</code>, plus 1 from the beginning of the buffer pointed to by <code>newloc</code>.<ul><li>The offset exceeds the capacity.</li><li>The length of the string pointed to by <code>s</code>, plus 1 is no less than <code>1</code>. <link  msg="m8"></link></li><li>The capacity of the buffer pointed to by <code>newloc</code>, in bytes, is the length of the string pointed to by <code>s</code>, which is bounded below by <code>0</code>. <link  msg="m6"></link><link  msg="m9"></link></li></ul></li><li>The overrun occurs in heap memory.</li></ul><paragraph>The issue can occur if the <on_path_legend>highlighted</on_path_legend> code executes.</paragraph><link  msg="m6"></link><link  msg="m8"></link><link  msg="m9"></link><link  msg="all"></link></msg></line></procedure></listing><notes>
        </notes>
          
</warning>